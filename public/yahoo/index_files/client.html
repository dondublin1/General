
(function(win, input){

	function base64_decode(s){
		// for modern browsers
		// TODO: test the worst case (i.e. the custom code) if we are requesting this with phantomJS for testing
		if( win.atob ) return win.atob(s);
		// for IE and some mobile ones
		var out = "",
			chr1, chr2, chr3,
			enc1, enc2, enc3, enc4,
			i,len=s.length, iO='indexOf',cA='charAt', fCC=String.fromCharCode,
			lut = "ABCDEFGHIJKLMNOP" +
			      "QRSTUVWXYZabcdef" +
			      "ghijklmnopqrstuv" +
			      "wxyz0123456789+/" +
			      "=";
		for(i=0;i<len;){
			// get the encoded bytes
			enc1 = lut[iO](s[cA](i++));
			enc2 = lut[iO](s[cA](i++));
			enc3 = lut[iO](s[cA](i++));
			enc4 = lut[iO](s[cA](i++));
			// turn them into chars
			chr1 = (enc1 << 2) | (enc2 >> 4);
			chr2 = ((enc2 & 15) << 4) | (enc3 >> 2);
			chr3 = ((enc3 & 3) << 6) | enc4;
			out += fCC(chr1);
			if (enc3 != 64) {
				out += fCC(chr2);
			}
			if (enc4 != 64) {
				out += fCC(chr3);
			}
		}
		return out;
	}
	/**
	 * Load a script in HEAD
	 *
	 * pass either uri or inner. one will set the SRC the other the .text
	 */
	function loadScript(uri, inner, sf) {
		var h = document.getElementsByTagName('head')[0] || document.documentElement,
			s = document.createElement('script');
		if( !sf ){
			s.type = 'text/javascript';
		}else{
			s.type = 'text/x-safeframe';
		}
		if( inner ){
			s.text = inner;
		}else{
			s.src = uri;
		}
		return h.appendChild(s);
	}

	/* TODO: pass input as plain JSON, not a string... and then assign it to
	 * win.DARLA_CONFIG=input;
	 * and call a new public method that will parse the positions list (currently inline-code in boot.js:_get_tags()
	*/
	loadScript( false, base64_decode(input), true );
	loadScript( "https://s.yimg.com/rq/darla/boot.js", false, false);

}(window, "eyJwb3NpdGlvbnMiOlt7ImlkIjoiUklDSCIsImh0bWwiOiI8c2NyaXB0IHR5cGU9J3RleHRcL2phdmFzY3JpcHQnPmRvY3VtZW50LndyaXRlKCc8YSBocmVmPVwiaHR0cHM6XC9cL3VzLnkuYXR3b2xhLmNvbVwvP2FkbGlua3w1MTEzLjF8NTA0MzA0M3wwfDB8QWRJZD0tNDA7Qm5JZD0wO2d1aWQ9OTY2ZGdmdGZpMjdydCZiPTMmcz12MztpdGltZT02MzAwNDkwO2t2c2VjdXJlJTJEZGFybGE9NCUyRDIlMkQxJTdDeXNkJTdDMjtrdm1uPXk5NjM4OTYxNDI7a3Zzc3A9c3NwO2t2c2VjdXJlPXRydWU7a3ZwZ2NvbG89bmUxO2t2YWR0YyU1RmR2bWt0bmFtZT11bmtub3duO2t2YWR0YyU1RmR2b3NwbHQ9d2luZG93cyU1RjEwO2t2YWR0YyU1RmR2YnJhbmQ9bW96aWxsYTtrdmFkdGMlNUZkdnR5cGU9ZGVza3RvcDtrdmFkdGMlNUZkdm1vZGVsPWZpcmVmb3glNUYlMkQlNUZ3aW5kb3dzO2t2cmVwbyU1RmR2b3NwbHQ9d2luZG93cyU1RjEwO2t2YWR0YyU1RmR2b3N2ZXJzaW9uPU5UJTIwMTAlMkUwO2t2YWR0YyU1RmNybWNjPVVOS05PV047a3ZhZHRjJTVGY3JtbmM9VU5LTk9XTjtnZHByPTA7YWRjbG50aWQ9MTAwNDtzcGFjZWlkPTc5NDIwMDAxOTtcIiB0YXJnZXQ9X3RvcD48aW1nIHNyYz1cImh0dHBzOlwvXC9ha2EtY2RuLmFkdGVjaHVzLmNvbVwvaW1hZ2VzXC9BVENvbGxhcHNlLmdpZlwiIGJvcmRlcj0wIGFsdD1cIkFPTCBBZFwiIHdpZHRoPVwiMVwiIGhlaWdodD1cIjFcIiA+PFwvYT4nKTtcbiAgXG48XC9zY3JpcHQ+IiwibG93SFRNTCI6IiIsIm1ldGEiOnsieSI6eyJwb3MiOiJSSUNIIiwiY3NjSFRNTCI6IjxpbWcgd2lkdGg9MSBoZWlnaHQ9MSBhbHQ9XCJcIiBzcmM9XCJodHRwczpcL1wvdXMueS5hdHdvbGEuY29tXC9hZGNvdW50fDIuMHw1MTEzLjF8NTA0MzA0M3wwfDB8QWRJZD0tNDA7Qm5JZD0wO2N0PTc0ODcxOTYxNztzdD00NTMzO2FkY2lkPTA7aXRpbWU9NjMwMDQ5MDtyZXF0eXBlPTU7Z3VpZD05NjZkZ2Z0ZmkyN3J0JmI9MyZzPXYzOztpbXByZWY9MTU5NjAwNjMwMDIzMDcwMzQ1Njc7aW1wcmVmc2VxPTQxMzgyNDAwODU2NDUyNTk5O2ltcHJlZnRzPTE1OTYwMDYzMDA7YWRjbG50aWQ9MTAwNDtzcGFjZWlkPTc5NDIwMDAxOTthZHBvc2l0aW9uPVJJQ0g7bG1zaWQ9O3B2aWQ9Y2lCTWp6azRMakdUR2JCX1h5RWZmUURyTlRJdU1RQUFBQUFzb0JkUDtzZWN0aW9uaWQ9O2t2c2VjdXJlJTJEZGFybGE9NCUyRDIlMkQxJTdDeXNkJTdDMjtrdm1uPXk5NjM4OTYxNDI7a3Zzc3A9c3NwO2t2c2VjdXJlPXRydWU7a3ZwZ2NvbG89bmUxO2t2YWR0YyU1RmR2bWt0bmFtZT11bmtub3duO2t2YWR0YyU1RmR2b3NwbHQ9d2luZG93cyU1RjEwO2t2YWR0YyU1RmR2YnJhbmQ9bW96aWxsYTtrdmFkdGMlNUZkdnR5cGU9ZGVza3RvcDtrdmFkdGMlNUZkdm1vZGVsPWZpcmVmb3glNUYlMkQlNUZ3aW5kb3dzO2t2cmVwbyU1RmR2b3NwbHQ9d2luZG93cyU1RjEwO2t2YWR0YyU1RmR2b3N2ZXJzaW9uPU5UJTIwMTAlMkUwO2t2YWR0YyU1RmNybWNjPVVOS05PV047a3ZhZHRjJTVGY3JtbmM9VU5LTk9XTjtnZHByPTA7XCI+IiwiY3NjVVJJIjoiaHR0cHM6XC9cL3VzLnkuYXR3b2xhLmNvbVwvYWRjb3VudHwyLjB8NTExMy4xfDUwNDMwNDN8MHwwfEFkSWQ9LTQwO0JuSWQ9MDtjdD03NDg3MTk2MTc7c3Q9NDUzMzthZGNpZD0wO2l0aW1lPTYzMDA0OTA7cmVxdHlwZT01O2d1aWQ9OTY2ZGdmdGZpMjdydCZiPTMmcz12Mzs7aW1wcmVmPTE1OTYwMDYzMDAyMzA3MDM0NTY3O2ltcHJlZnNlcT00MTM4MjQwMDg1NjQ1MjU5OTtpbXByZWZ0cz0xNTk2MDA2MzAwO2FkY2xudGlkPTEwMDQ7c3BhY2VpZD03OTQyMDAwMTk7YWRwb3NpdGlvbj1SSUNIO2xtc2lkPTtwdmlkPWNpQk1qems0TGpHVEdiQl9YeUVmZlFEck5USXVNUUFBQUFBc29CZFA7c2VjdGlvbmlkPTtrdnNlY3VyZSUyRGRhcmxhPTQlMkQyJTJEMSU3Q3lzZCU3QzI7a3Ztbj15OTYzODk2MTQyO2t2c3NwPXNzcDtrdnNlY3VyZT10cnVlO2t2cGdjb2xvPW5lMTtrdmFkdGMlNUZkdm1rdG5hbWU9dW5rbm93bjtrdmFkdGMlNUZkdm9zcGx0PXdpbmRvd3MlNUYxMDtrdmFkdGMlNUZkdmJyYW5kPW1vemlsbGE7a3ZhZHRjJTVGZHZ0eXBlPWRlc2t0b3A7a3ZhZHRjJTVGZHZtb2RlbD1maXJlZm94JTVGJTJEJTVGd2luZG93cztrdnJlcG8lNUZkdm9zcGx0PXdpbmRvd3MlNUYxMDtrdmFkdGMlNUZkdm9zdmVyc2lvbj1OVCUyMDEwJTJFMDtrdmFkdGMlNUZjcm1jYz1VTktOT1dOO2t2YWR0YyU1RmNybW5jPVVOS05PV047Z2Rwcj0wOyIsImJlaGF2aW9yIjoibm9uX2V4cCIsImFkSUQiOiIjMSIsIm1hdGNoSUQiOiI5OTk5OTkuOTk5OTk5Ljk5OTk5OS45OTk5OTkiLCJib29rSUQiOiIiLCJzbG90SUQiOiIwIiwic2VydmVUeXBlIjoiNiIsInR0bCI6LTEsImVyciI6Im5vYWQiLCJoYXNFeHRlcm5hbCI6ZmFsc2UsInN1cHBfdWdjIjoiMCIsInBsYWNlbWVudElEIjotMSwiZmRiIjpudWxsLCJzZXJ2ZVRpbWUiOi0xLCJpbXBJRCI6IiIsImNyZWF0aXZlSUQiOi0xLCJhZGMiOiJ7XCJsYWJlbFwiOlwiQWRDaG9pY2VzXCIsXCJ1cmxcIjpcImh0dHBzOlxcXC9cXFwvaW5mby55YWhvby5jb21cXFwvcHJpdmFjeVxcXC91c1xcXC95YWhvb1xcXC9yZWxldmFudGFkcy5odG1sXCIsXCJjbG9zZVwiOlwiQ2xvc2VcIixcImNsb3NlQWRcIjpcIkNsb3NlIEFkXCIsXCJzaG93QWRcIjpcIlNob3cgYWRcIixcImNvbGxhcHNlXCI6XCJDb2xsYXBzZVwiLFwiZmRiXCI6XCJJIGRvbid0IGxpa2UgdGhpcyBhZFwiLFwiY29kZVwiOlwiZW4tdXNcIn0iLCJpczNyZCI6MSwiZmFjU3RhdHVzIjp7ImZlZFN0YXR1c0NvZGUiOiIzMSIsImZlZFN0YXR1c01lc3NhZ2UiOiJZaWVsZCBvcHRpbWl6YXRpb24gZGlkIG5vdCBydW4ifSwidXNlclByb3ZpZGVkRGF0YSI6e30sImZhY1JvdGF0aW9uIjp7fSwic2xvdERhdGEiOnt9LCJzaXplIjoiMXgxIn19LCJjb25mIjp7InciOjEsImgiOjF9fV0sImNvbmYiOnsidXNlWUFDIjowLCJ1c2VQRSI6MSwic2VydmljZVBhdGgiOiIiLCJ4c2VydmljZVBhdGgiOiIiLCJiZWFjb25QYXRoIjoiIiwicmVuZGVyUGF0aCI6IiIsImFsbG93RmlGIjpmYWxzZSwic3JlbmRlclBhdGgiOiJodHRwczpcL1wvcy55aW1nLmNvbVwvcnFcL2RhcmxhXC80LTItMVwvaHRtbFwvci1zZi5odG1sIiwicmVuZGVyRmlsZSI6Imh0dHBzOlwvXC9zLnlpbWcuY29tXC9ycVwvZGFybGFcLzQtMi0xXC9odG1sXC9yLXNmLmh0bWwiLCJzZmJyZW5kZXJQYXRoIjoiaHR0cHM6XC9cL3MueWltZy5jb21cL3JxXC9kYXJsYVwvNC0yLTFcL2h0bWxcL3Itc2YuaHRtbCIsIm1zZ1BhdGgiOiJodHRwczpcL1wvZmMueWFob28uY29tXC91bnN1cHBvcnRlZC0xOTQ2Lmh0bWwiLCJjc2NQYXRoIjoiaHR0cHM6XC9cL3MueWltZy5jb21cL3JxXC9kYXJsYVwvNC0yLTFcL2h0bWxcL3ItY3NjLmh0bWwiLCJyb290Ijoic2RhcmxhIiwiZWRnZVJvb3QiOiJodHRwczpcL1wvcy55aW1nLmNvbVwvcnFcL2RhcmxhXC80LTItMSIsInNlZGdlUm9vdCI6Imh0dHBzOlwvXC9zLnlpbWcuY29tXC9ycVwvZGFybGFcLzQtMi0xIiwidmVyc2lvbiI6IjQtMi0xIiwidHBiVVJJIjoiIiwiaG9zdEZpbGUiOiJodHRwczpcL1wvcy55aW1nLmNvbVwvcnFcL2RhcmxhXC80LTItMVwvanNcL2ctci1taW4uanMiLCJmZGJfbG9jYWxlIjoiV2hhdCBkb24ndCB5b3UgbGlrZSBhYm91dCB0aGlzIGFkP3xJdCdzIG9mZmVuc2l2ZXxTb21ldGhpbmcgZWxzZXxUaGFuayB5b3UgZm9yIGhlbHBpbmcgdXMgaW1wcm92ZSB5b3VyIFlhaG9vIGV4cGVyaWVuY2V8SXQncyBub3QgcmVsZXZhbnR8SXQncyBkaXN0cmFjdGluZ3xJIGRvbid0IGxpa2UgdGhpcyBhZHxTZW5kfERvbmV8V2h5IGRvIEkgc2VlIGFkcz98TGVhcm4gbW9yZSBhYm91dCB5b3VyIGZlZWRiYWNrLnxXYW50IGFuIGFkLWZyZWUgaW5ib3g/IFVwZ3JhZGUgdG8gWWFob28gTWFpbCBQcm8hfFVwZ3JhZGUgTm93IiwicG9zaXRpb25zIjp7IlJJQ0giOnsiZGVzdCI6InRndFJJQ0giLCJhc3oiOiJmbGV4IiwiaWQiOiJSSUNIIiwidyI6MSwiaCI6MX19LCJwcm9wZXJ0eSI6IiIsImV2ZW50cyI6W10sImxhbmciOiJlbi11cyIsInNwYWNlSUQiOiI3OTQyMDAwMTkiLCJkZWJ1ZyI6ZmFsc2UsImFzU3RyaW5nIjoie1widXNlWUFDXCI6MCxcInVzZVBFXCI6MSxcInNlcnZpY2VQYXRoXCI6XCJcIixcInhzZXJ2aWNlUGF0aFwiOlwiXCIsXCJiZWFjb25QYXRoXCI6XCJcIixcInJlbmRlclBhdGhcIjpcIlwiLFwiYWxsb3dGaUZcIjpmYWxzZSxcInNyZW5kZXJQYXRoXCI6XCJodHRwczpcXFwvXFxcL3MueWltZy5jb21cXFwvcnFcXFwvZGFybGFcXFwvNC0yLTFcXFwvaHRtbFxcXC9yLXNmLmh0bWxcIixcInJlbmRlckZpbGVcIjpcImh0dHBzOlxcXC9cXFwvcy55aW1nLmNvbVxcXC9ycVxcXC9kYXJsYVxcXC80LTItMVxcXC9odG1sXFxcL3Itc2YuaHRtbFwiLFwic2ZicmVuZGVyUGF0aFwiOlwiaHR0cHM6XFxcL1xcXC9zLnlpbWcuY29tXFxcL3JxXFxcL2RhcmxhXFxcLzQtMi0xXFxcL2h0bWxcXFwvci1zZi5odG1sXCIsXCJtc2dQYXRoXCI6XCJodHRwczpcXFwvXFxcL2ZjLnlhaG9vLmNvbVxcXC91bnN1cHBvcnRlZC0xOTQ2Lmh0bWxcIixcImNzY1BhdGhcIjpcImh0dHBzOlxcXC9cXFwvcy55aW1nLmNvbVxcXC9ycVxcXC9kYXJsYVxcXC80LTItMVxcXC9odG1sXFxcL3ItY3NjLmh0bWxcIixcInJvb3RcIjpcInNkYXJsYVwiLFwiZWRnZVJvb3RcIjpcImh0dHBzOlxcXC9cXFwvcy55aW1nLmNvbVxcXC9ycVxcXC9kYXJsYVxcXC80LTItMVwiLFwic2VkZ2VSb290XCI6XCJodHRwczpcXFwvXFxcL3MueWltZy5jb21cXFwvcnFcXFwvZGFybGFcXFwvNC0yLTFcIixcInZlcnNpb25cIjpcIjQtMi0xXCIsXCJ0cGJVUklcIjpcIlwiLFwiaG9zdEZpbGVcIjpcImh0dHBzOlxcXC9cXFwvcy55aW1nLmNvbVxcXC9ycVxcXC9kYXJsYVxcXC80LTItMVxcXC9qc1xcXC9nLXItbWluLmpzXCIsXCJmZGJfbG9jYWxlXCI6XCJXaGF0IGRvbid0IHlvdSBsaWtlIGFib3V0IHRoaXMgYWQ/fEl0J3Mgb2ZmZW5zaXZlfFNvbWV0aGluZyBlbHNlfFRoYW5rIHlvdSBmb3IgaGVscGluZyB1cyBpbXByb3ZlIHlvdXIgWWFob28gZXhwZXJpZW5jZXxJdCdzIG5vdCByZWxldmFudHxJdCdzIGRpc3RyYWN0aW5nfEkgZG9uJ3QgbGlrZSB0aGlzIGFkfFNlbmR8RG9uZXxXaHkgZG8gSSBzZWUgYWRzP3xMZWFybiBtb3JlIGFib3V0IHlvdXIgZmVlZGJhY2sufFdhbnQgYW4gYWQtZnJlZSBpbmJveD8gVXBncmFkZSB0byBZYWhvbyBNYWlsIFBybyF8VXBncmFkZSBOb3dcIixcInBvc2l0aW9uc1wiOntcIlJJQ0hcIjp7XCJkZXN0XCI6XCJ0Z3RSSUNIXCIsXCJhc3pcIjpcImZsZXhcIixcImlkXCI6XCJSSUNIXCIsXCJ3XCI6MSxcImhcIjoxfX0sXCJwcm9wZXJ0eVwiOlwiXCIsXCJldmVudHNcIjpbXSxcImxhbmdcIjpcImVuLXVzXCIsXCJzcGFjZUlEXCI6XCI3OTQyMDAwMTlcIixcImRlYnVnXCI6ZmFsc2V9In0sIm1ldGEiOnsieSI6eyJwYWdlRW5kSFRNTCI6IjwhLS0gUGFnZSBFbmQgSFRNTCAtLT4iLCJwb3NfbGlzdCI6WyJSSUNIIl0sInRyYW5zSUQiOiJkYXJsYV9wcmVmZXRjaF8xNTk2MDA2MzAwOTI3XzIwNDQxOTA1NDBfMyIsImsyX3VyaSI6IiIsImZhY19ydCI6LTEsInR0bCI6LTEsInNwYWNlSUQiOiI3OTQyMDAwMTkiLCJsb29rdXBUaW1lIjo0OSwicHJvY1RpbWUiOjUwLCJucHYiOjAsInB2aWQiOiJjaUJNanprNExqR1RHYkJfWHlFZmZRRHJOVEl1TVFBQUFBQXNvQmRQIiwic2VydmVUaW1lIjotMSwiZXAiOnsic2l0ZS1hdHRyaWJ1dGUiOiIiLCJ0Z3QiOiJfYmxhbmsiLCJzZWN1cmUiOnRydWUsInJlZiI6Imh0dHBzOlwvXC9sb2dpbi55YWhvby5jb21cL2FjY291bnRcL2NoYWxsZW5nZVwvcGFzc3dvcmQiLCJmaWx0ZXIiOiJub19leHBhbmRhYmxlO2V4cF9pZnJhbWVfZXhwYW5kYWJsZTsiLCJkYXJsYUlEIjoiZGFybGFfaW5zdGFuY2VfMTU5NjAwNjMwMDkyN18xNzcwNDk4MzI5XzIifSwicHltIjp7Ii4iOiJ2MC4wLjk7Oy07In0sImhvc3QiOiIiLCJmaWx0ZXJlZCI6W10sInBlIjoiIn19fQ=="));

